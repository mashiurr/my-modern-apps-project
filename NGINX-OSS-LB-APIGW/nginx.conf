
user  nginx;
worker_processes  auto;

error_log  /var/log/nginx/error.log notice;
pid        /run/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    keepalive_timeout  65;

    #gzip  on;

    include /etc/nginx/conf.d/*.conf;


### 1. NGINX LB config for Kubernetes-Dashboard App in k8s-Cluster

#server {
#    listen 443 ssl;
#    server_name dashboard.mashlab.com;

#    ssl_certificate /etc/nginx/ssl/dashboard-mashlab-com-cert.crt;
#    ssl_certificate_key /etc/nginx/ssl/dashboard-mashlab-com-tls.key;

#    location / {
#        proxy_pass https://10.1.1.4:30876;
#        proxy_set_header Host $host;
#        proxy_set_header X-Forwarded-Proto https;
#        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#        proxy_set_header X-Real-IP $remote_addr;
#    }
#}

# 2. whisker NodePort of the Calico-Dashboard Traffic Flow service in Calico-System Namespace

#server {
#    listen 80;
#    listen 443 ssl;
#    server_name whisker.mashlab.com;

#    ssl_certificate /etc/nginx/ssl/whisker-mashlab.com-cert.crt;
#    ssl_certificate_key /etc/nginx/ssl/whisker-mashlab.com-tls.key;

#    location / {
#        proxy_pass http://10.1.1.4:32451;
#        proxy_set_header Host $host;
#        proxy_set_header X-Real-IP $remote_addr;
#        }
#}


# 3. NGINX NodePort of the nginx-ingress-controller service for Test-App in k8S-Cluster 

#server {
#    listen 80;
#    server_name test.mashlab.com;

#    location / {
#        proxy_pass http://10.1.1.4:31470;
#        proxy_set_header Host $host;
#        proxy_set_header X-Real-IP $remote_addr;
#        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#        proxy_set_header X-Forwarded-Proto $scheme;
#
#        }
#}

### 4. NGINX API GW config for hello test API in k8s-Cluster 

#server {
#   listen 80;
#   server_name api.mashlab.com;

#   location / {
#        proxy_pass http://10.1.1.5:30223;
#        proxy_set_header Host $host;
#        proxy_set_header X-Real-IP $remote_addr;
#        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#        proxy_set_header X-Forwarded-Proto $scheme;
#   }

#}

### 5. NGINX LB config for Juiceshop API App in k8s-Cluster

#server {
#   listen 80;
#   server_name juice.mashlab.com;

#   location / {
#        proxy_pass http://10.1.1.6:30983;
#        proxy_set_header Host $host;
#        proxy_set_header X-Real-IP $remote_addr;
#        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#        proxy_set_header X-Forwarded-Proto $scheme;
#   }

#}


### 6. NGINX LB Config for F5 Arcadia-Finance-App in K8s-Cluster
#server {
#    listen 80;
#    listen 443 ssl;
#    server_name arcadia.mashlab.com;

#    ssl_certificate /etc/nginx/ssl/arcadia-mashlab-com-cert.crt;
#    ssl_certificate_key /etc/nginx/ssl/arcadia-mashlab-com-tls.key;


#    location / {
#        proxy_pass http://10.1.1.6:30511;
#        proxy_set_header Host $host;
#        proxy_set_header X-Real-IP $remote_addr;
#        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#        proxy_set_header X-Forwarded-Proto $scheme;
#        }

#    location /files {
#        proxy_pass http://10.1.1.6:31584;
#        }

#    location /api {
#        proxy_pass http://10.1.1.6:30362;
#        }

#    location /app3 {
#        proxy_pass http://10.1.1.6:31662;
#        }

#}

### 7. Optional redirect from HTTP to HTTPS for "arcadia..mashlab.com"
#server {
#    listen 80;
#    server_name arcadia.mashlab.com;
#    return 301 https://$host$request_uri;
#}


### 8. NGINX LB config for Cafe Apps & API in k8s with SSL
#server {
#    listen 443 ssl;
#    server_name cafeapp.mashlab.com;

#    ssl_certificate     /etc/nginx/ssl/cafeapp-mashlab.com-cert.crt;
#    ssl_certificate_key /etc/nginx/ssl/cafeapp-mashlab.com-tls.key;

#    location /coffee {
#        proxy_pass https://cafe.mashlab.com:31443/coffee/;
#        proxy_set_header Host cafe.mashlab.com;
#        proxy_set_header X-Real-IP $remote_addr;
#        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#        proxy_set_header X-Forwarded-Proto $scheme;
#        proxy_ssl_verify off;  # Only keep if backend cert isn't trusted

#    }

#    location /tea {
#        proxy_pass https://cafe.mashlab.com:31443/tea/;
#        proxy_set_header Host cafe.mashlab.com;
#        proxy_set_header X-Real-IP $remote_addr;
#        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#        proxy_set_header X-Forwarded-Proto $scheme;
#        proxy_ssl_verify off; # Only keep if backend cert isn't trusted
#    }
#}

#####--End-Of-Section-Bracket--##

}
